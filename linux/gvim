#!/bin/bash -eu

if ! [ -t 0 ]; then
    # If we are piping lines into this script, then open them with gvim.
    ~/script/linux/forward-lines /usr/bin/gvim --remote-tab-silent
elif [ $# -eq 0 ]; then
    # If we have no files as arguments, then open a new tab and focus
    # the window.
    /usr/bin/gvim --remote-send '<Esc>:tablast<CR><Esc>:tabnew<CR>' \
        > /dev/null 2>&1|| /usr/bin/gvim > /dev/null 2>&1
    ~/script/linux/raise-by-class gvim
else
    # Open all of the listed files in GVim
    /usr/bin/gvim --remote-tab-silent "$@" > /dev/null 2>&1
fi
